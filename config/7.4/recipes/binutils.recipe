set -o errexit +o hashall;unset CDPATH;umask 022
addSourcePackageDownload 2.23.2 "$LFS_MIRROR_GNU"/"$LFS_SOURCE_PACKAGE_NAME"/"$LFS_SOURCE_PACKAGE_NAME"-2.23.2.tar.bz2 MD5:4f8fa651e35ef262edc01d60fb45702e,KEYRING:gnu-keyring.gpg

function installPackage_toolchain1_binutils()
{
	sed -i -e 's/@colophon/@@colophon/' -e 's/doc@cygnus.com/doc@@cygnus.com/' bfd/doc/bfd.texinfo

	createBuildFolderAndPushd

		../"$LFS_EXTRACTED_TARBALL_FOLDER"/configure \
		--prefix=/"$LFS_TOOLS" \
		--with-sysroot="$LFS" \
		--with-lib-path=/"$LFS_TOOLS"/lib \
		--target="$LFS_TGT" \
		--disable-nls \
		--disable-werror

		make

		# Ensure toolchain sanity on 64-bit x864
		case "$(uname -m)" in
			x86_64)
				mkdir -m 0755 -p /"$LFS_TOOLS"/lib
				ln --symbolic lib /"$LFS_TOOLS"/lib64
			;;
		esac

		make install

	popdBuildFolder
}

function installPackage_toolchain2_binutils()
{
	sed -i -e 's/@colophon/@@colophon/' -e 's/doc@cygnus.com/doc@@cygnus.com/' bfd/doc/bfd.texinfo
	
	createBuildFolderAndPushd
		
		CC=$LFS_TGT-gcc                           \
		AR=$LFS_TGT-ar                            \
		RANLIB=$LFS_TGT-ranlib                    \
		../"$LFS_EXTRACTED_TARBALL_FOLDER"/configure \
		--prefix=/"$LFS_TOOLS"                    \
		--disable-nls                             \
		--with-lib-path=/"$LFS_TOOLS"/lib         \
		--with-sysroot
		
		make
		
		make install
		
		make -C ld clean
		make -C ld LIB_PATH=/usr/lib:/lib
		cp -v ld/ld-new /"$LFS_TOOLS"/bin
		
	popdBuildFolder
}
