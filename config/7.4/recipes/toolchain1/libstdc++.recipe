set -o errexit +o hashall

depends glibc 2.18

include_once gcc

# Bit of an oddity, as this depends on gcc.recipe already having run; requires the gcc source tarball to have been extracted
# Unlike most other installers, this one uses someone else's tar ball (in this case, gcc)
function localPackage_toolchain1_libstdc_useGccTarball()
{
	local -r key="$(printKey gcc "$LFS_SOURCE_PACKAGE_VERSION")"
	source_package_without_download "$LFS_SOURCE_PACKAGE_NAME" "$LFS_SOURCE_PACKAGE_VERSION" ${sourcePackages_Compression["${key}"]} ${sourcePackages_FileName["${key}"]} ${sourcePackages_ExtractedTarballFolder["${key}"]}
}
localPackage_toolchain1_libstdc_useGccTarball

function installPackage_toolchain1_libstdc++()
{
	createBuildFolderAndPushd "gcc"
	
		../gcc-"$LFS_SOURCE_PACKAGE_VERSION"/libstdc++-v3/configure \
		--host="$LFS_TGT"                                      \
		--prefix=/"$LFS_TOOLS"                                        \
		--disable-multilib                                     \
		--disable-shared                                       \
		--disable-nls                                          \
		--disable-libstdcxx-threads                            \
		--disable-libstdcxx-pch                                \
		--with-gxx-include-dir=/"$LFS_TOOLS"/"$LFS_TGT"/include/c++/"$LFS_SOURCE_PACKAGE_VERSION"
	
		make
	
		make install
		
	popdBuildFolder
}
