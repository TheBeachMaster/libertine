set -o errexit +o hashall

# Ensures gcc versions in LFS_SOURCE_PACKAGE_VERSIONS are defined (gcc is a dependency of glibc)
depends glibc

# version introduces a list - local variables work because we're sourced from inside a function
local gccVersion
local gccPackageVersionKey
for gccVersion in ${LFS_SOURCE_PACKAGE_VERSIONS[gcc]}
do
	version "$gccVersion"
	{
		depends glibc
	
		gccPackageVersionKey="$(printKey gcc "$gccVersion")"
	
		source_package_without_download "$LFS_SOURCE_PACKAGE_NAME" "$gccVersion" "${sourcePackages_Compression["${key}"]}" "${sourcePackages_FileName["${key}"]}" "${sourcePackages_ExtractedTarballFolder["${key}"]}"
	
		localPackage_toolchain1_libstdc++_useGccTarball
	}
done

function installPackage_toolchain1_libstdc++()
{
	local gccVersion="$LFS_SOURCE_PACKAGE_VERSION"
	local -r gccPackageVersionKey="$(printKey gcc "$gccVersion")"
	
	createBuildFolderAndPushd "gcc" "$gccVersion"
	
		../"${sourcePackages_ExtractedTarballFolder["${gccPackageVersionKey}"]}"/libstdc++-v3/configure \
		--host="$LFS_TGT"                                      \
		--prefix=/"$LFS_TOOLS"                                        \
		--disable-multilib                                     \
		--disable-shared                                       \
		--disable-nls                                          \
		--disable-libstdcxx-threads                            \
		--disable-libstdcxx-pch                                \
		--with-gxx-include-dir=/"$LFS_TOOLS"/"$LFS_TGT"/include/c++/"$gccVersion"
	
		make
	
		make install
		
	popdBuildFolder
}
